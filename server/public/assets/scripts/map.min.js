/*! tcs_master 2015-12-15 */
var myLatLng={},storesFound=[],storeContent=[];$(document).ready(function(){var a=1;$("#navMenu").click(function(){1==a?($(this).stop(!0,!1).animate({bottom:150},600),a=0):($(this).stop(!0,!1).animate({bottom:50},600),a=1)}),getCurrentLocation()});var findStore=function(){console.log("The location data being sent to the db as search criteria: ",myLatLng),$.ajax({type:"GET",url:"/addStore",data:myLatLng,success:function(a){return console.log("The data response from the db: ",a),storesFound=a,console.log("The storesFound: ",storesFound),initMap(myLatLng,storesFound),storesFound}})},getCurrentLocation=function(){function a(a,b,c){b.setPosition(c),b.setContent(a?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation.")}myLatLng={},navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){myLatLng.lat=parseFloat(a.coords.latitude),myLatLng.lng=parseFloat(a.coords.longitude),console.log("The variable LatLng: ",myLatLng),findStore()}):a(!1,infoWindow,map.getCenter())},initMap=function(a,b){storeContent=[];var c,d,e=new google.maps.InfoWindow,f=new google.maps.Map(document.getElementById("map"),{zoom:12,center:a}),g=new google.maps.Marker({position:a,map:f,title:"You Are Here"});g.addListener("click",function(){console.log("center")}),console.log("What is the storesFound?: ",b);for(var d=0;d<b.length;d++){console.log("Processing the marker data: ",b[d]);var c=new google.maps.Marker({position:new google.maps.LatLng(b[d].latlong[0],b[d].latlong[1]),map:f,title:b[d].name,icon:"http://maps.google.com/mapfiles/ms/micons/purple-dot.png"}),h=setContentstring(b[d]);storeContent.push(h),console.log("The storeContent is: ",storeContent),google.maps.event.addListener(c,"click",function(a,b){return console.log("click!"),function(){e.setContent(storeContent[b]),e.open(f,a)}}(c,d))}},setContentstring=function(a){return contentString='<div class="container"><div class="col-xs-4"><img src="http://www.logoorange.com/thumb-portfolio/logo_thumbnail_military-design-logo.png" alt="store logo"/></div><div class="col-xs-8"><h4>'+a.name+"</h4><h5>"+a.description+"</h5><h5>Distance</h5><h5>Directions</h5></div></div>",contentString};